<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Available Dogs</title>
    <meta name="description" content="List of SC Sheltie Rescue dogs available for adoption.">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160" />
    <meta name="msapplication-TileColor" content="#2ba6cb" />
    <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/mstile-310x310.png" />

    <link rel="stylesheet" href="css/app.20140105.css"> <!-- Cache Busting: Update the # when you update main.css -->
    <script src="bower_components/modernizr/modernizr.js"></script>
  </head>
  <body>
    <!--[if lte IE 8]>
    <div data-alert class="alert-box warning browsehappy-alert">
      You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.
      <a href="#" class="close">&times;</a>
    </div>
    <![endif]-->

    <div class="page-wrap">
      <div class="contain-to-grid fixed">
        <nav class="top-bar" data-topbar>
          <ul class="title-area">
            <!-- Title Area -->
            <li class="name">
              <h1 class="show-for-large-up"><a href="index.html">South Carolina Sheltie Rescue</a></h1>
              <h1 class="show-for-medium-down"><a href="index.html">SCSR</a></h1>
            </li>
            <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
            <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
          </ul>

          <section class="top-bar-section">
            <ul class="right">
              <li><a href="index.html">Home</a></li>
              <li class="has-dropdown"><a href="available_dogs.html">Adopt</a>
                <ul class="dropdown">
                  <li><a href="adoption_requirements.html">Adoption Requirements</a></li>
                  <li class="active"><a href="available_dogs.html">Adoptable Dogs</a></li>
                  <li><a href="apply_to_adopt.php">Adoption Application</a></li>
                  <li><a href="apply_to_foster.php">Fostering Application</a></li>
                </ul>
              </li>
              <li><a href="surrender.html">Surrender a Sheltie</a></li>
              <li><a href="help_and_advice.html">Help and Advice</a></li>
              <li><a href="events.html">Rescue Events</a></li>
            </ul>
          </section>
        </nav>
      </div>

      <div class="row">
        <div class="large-12 medium-12 small-12 columns">
          <main role="main" class="main-content">
            <div class="cushycms">
              <h2 class="headline first">Available for Adoption</h2>
              <p>You can view our available dogs below or on our <a href="http://www.petfinder.com/pet-search?animal_type=&pet_breed=&pet_age=&pet_size=&specialNeeds=&declawedPets=&children=&status=&shelter_pet_id=&internal=&contact=&name=&shelter_id=SC92&sort=" target="_blank">Petfinder site</a>. If you are interested in adopting one of our rescue dogs, please complete and submit our <a href="apply_to_adopt.php">Adoption Application</a> form. If you have any questions feel free to <a href="mailto:amanda@southcarolinasheltierescue.com">email</a> us.</p>
            </div>

            <div id="pets" class="clearfix"></div>
            <div id="spinner" class="loading_spinner"></div>

            <input id="btnMore" type="button" class="large button expand invisible" value="View More" />
          </main>
        </div>
      </div>
    </div>

    <footer class="main-footer">
      <section id="social-media" class="social-media">
        <a href="http://www.petfinder.com/pet-search?shelterid=SC92" target="_blank">
          <span class="icon-bone"></span><span class="visuallyhidden">Petfinder</span>
        </a>
        <a href="https://www.facebook.com/SouthCarolinaSheltieRescue" target="_blank">
          <span class="icon-facebook"></span><span class="visuallyhidden">Facebook</span>
        </a>
        <a href="https://twitter.com/scsheltierescue" target="_blank">
          <span class="icon-twitter"></span><span class="visuallyhidden">Twitter</span>
        </a>
      </section>
      <section id="address" class="address">
        <p class="no-margin-bottom">
          <span class="name">SC Sheltie Rescue</span><br/>
          <span class="po-box">P.O. Box 11414</span><br/>
          <span class="city-state-zip">Columbia, SC 29211</span><br/>
          <span class="tel"><a href="tel:+18039200644">803.920.0644</a></span>
        </p>
      </section>
      <section id="copyright" class="copyright">
        <small>&copy; <script>document.write(new Date().getFullYear())</script><noscript>2013</noscript> South Carolina Sheltie Rescue</small>
      </section>
    </footer>


    <script src="bower_components/jquery/jquery.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>
    <script>
      var currentOffset = 0;
      var maxOffset = 25;
      var opts = {
        lines: 13, // The number of lines to draw
        length: 20, // The length of each line
        width: 10, // The line thickness
        radius: 30, // The radius of the inner circle
        corners: 1, // Corner roundness (0..1)
        rotate: 0, // The rotation offset
        direction: 1, // 1: clockwise, -1: counterclockwise
        color: '#000', // #rgb or #rrggbb or array of colors
        speed: 0.7, // Rounds per second
        trail: 25, // Afterglow percentage
        shadow: false, // Whether to render a shadow
        hwaccel: false, // Whether to use hardware acceleration
        className: 'spinner', // The CSS class to assign to the spinner
        zIndex: 2e9, // The z-index (defaults to 2000000000)
        top: 'auto', // Top position relative to parent in px
        left: 'auto' // Left position relative to parent in px
      };
      var spinner_target = document.getElementById('spinner');
      var spinner = null;

      function spin_start() {
        spinner.spin(spinner_target);
      }

      function spin_stop() {
        spinner.stop();
      }

      /*
       * Call petfinder.php to get a list of available dogs. Then append to the HTML document.
       */
      function getPets() {
        var $btnMore = $("#btnMore");
        var $spinner = $("#spinner");
        var url = "petfinder.php";
        var data = {
          offset: currentOffset
        };

        if(!$btnMore.hasClass("invisible")) {
          $btnMore.addClass("invisible");
        }
        $spinner.show();
        if(!spinner) {
          spinner = new Spinner(opts).spin(spinner_target);
        } else {
          spin_start();
        }

        $.getJSON(url, data, function(resp) {
          currentOffset = parseInt(resp.petfinder.lastOffset.$t, 10);
          var pets = resp.petfinder.pets.pet;

          $(pets).each(function(i, item) {
            $("#pets").append(formatPet(item));
          });

          $spinner.hide();
          spin_stop();
          if(pets && pets.length === maxOffset) { // Pulled the maximum amount of pets
            $btnMore.removeClass("invisible");
          }

          return true;
        }, "json").then(function() {
          $(document).foundation('clearing');
        });
      }

      /*
       * Format each pet HTML block.
       */
      function formatPet(pet) {
        var div = $("<div class='clearfix panel'></div>"),
          headerDiv = $("<div class='clearfix'></div>"),
          name = pet.name.$t,
          desc = pet.description.$t.trim(),
          first = true;

        if(name === "Application") {
          return null;
        }

        $(headerDiv).append("<h2 class='pet-name'><span class='radius label'>"+name+"</span></h2>");
        ul = $('<ul/>', {class: 'options'});
        $(pet.options.option).each(function(i, option) {
          var listchild;
          li = $('<li/>');
          switch (option.$t) {
            case "altered":
              if(pet.sex.$t === "M") {
                listchild = $('<span/>', {text: "Neutered: "});
              } else if(pet.sex.$t === "F") {
                listchild = $('<span/>', {text: "Spayed: "});
              } else {
                listchild = $('<span/>', {text: "Spayed/Neutered: "});
              }
              listchild.append($('<span/>', {class: "icon-checkmark"}));
              break;
            case "hasShots":
              listchild = $('<span/>', {text: "Shots Current: "});
              listchild.append($('<span/>', {class: "icon-checkmark"}));
              break;
            case "housebroken":
              listchild = $('<span/>', {text: "Housebroken: "});
              listchild.append($('<span/>', {class: "icon-checkmark"}));
              break;
            case "noKids":
              listchild = $('<strong/>', {text: "No Kids"});
              break;
            case "noCats":
              listchild = $('<strong/>', {text: "No Cats"});
              break;
          }
          ul.append(li.append(listchild));
        });
        $(div).append(headerDiv.append(ul));

        if (desc.match("^<div>") && desc.match("</div>$")) {
          desc = desc.replace(/^<div>/,"<p>");
          desc = desc.replace(/<\/div>$/,"</p>");
        }
        desc = $("<div class='clearfix'>"+desc+"</div>");

        if(pet.media.photos && pet.media.photos.photo.length > 0)
        {
          var photos = pet.media.photos.photo,
            ul = $('<ul/>', {class: 'clearing-thumbs clearing-feature', 'data-clearing': ''}),
            li, anchor, img;

          $(photos).each(function(i, photo) {
            if(photo['@size'] == "x") {
              li = (first) ? $('<li/>', {class: 'clearing-featured-img'}) : $('<li/>');
              first = false;
              anchor = $('<a/>', {href: photo.$t});
              img = $('<img/>', {src: photo.$t}).attr('alt', name + photo['@id']).css({
                  border:"solid 2px gainsboro",
                  padding:"3px",
                  margin:"5px",
                  width:"200px"
                });
              ul.append(li.append(anchor.append(img)));
            }
          });
          first = true;
          $(desc).prepend(ul);
        }
        $(div).append(desc).css({padding: "4px", margin: "3px 3px 20px 3px"});

        return div;
      }

      /*
       * Retrieve data on document ready.
       */
      $(document).ready(function() {
        getPets();
        $("#btnMore").click(function() {
          getPets();
        });
      });
    </script>
    <script>
      $(document).foundation();
    </script>
  </body>
</html>